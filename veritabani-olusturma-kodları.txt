create database vtbsProje_n;
use vtbsProje_n;

-- Ürünler
CREATE TABLE kategori (
    id INT AUTO_INCREMENT PRIMARY KEY,
    kategori_adi VARCHAR(30) NOT NULL
);

CREATE TABLE markalar (
    id INT AUTO_INCREMENT PRIMARY KEY,
    marka_adi VARCHAR(20) NOT NULL
);

CREATE TABLE urunler (
    id INT AUTO_INCREMENT PRIMARY KEY,
    urun_adi VARCHAR(30) NOT NULL,
    marka_id INT,
    kategori_id INT,
    fiyat DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (kategori_id) REFERENCES kategori(id),
    FOREIGN KEY (marka_id) REFERENCES markalar(id)
);

-- magaza

CREATE TABLE magazalar (
id INT AUTO_INCREMENT PRIMARY KEY,
ad varchar(50),
adres varchar(250)
);

-- Kulanıcılar

CREATE TABLE unvanlar (
id INT AUTO_INCREMENT PRIMARY KEY,
aciklama varchar(50)
);

CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password_hash VARCHAR(255),
    rol INT NOT NULL DEFAULT 1, -- Admin=0, Calisan=1
    ad VARCHAR(20) NOT NULL,
    soyad VARCHAR(20) NOT NULL,
    unvan_id INT,
    maas DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (unvan_id) REFERENCES unvanlar(id)
);

CREATE TABLE musteriler (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ad VARCHAR(20) NOT NULL,
    soyad VARCHAR(20) NOT NULL
);

CREATE TABLE telefon_nolar (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tel_no VARCHAR(11)
);

CREATE TABLE adresler (
id INT AUTO_INCREMENT PRIMARY KEY,
adres varchar(250)
);

CREATE TABLE adresler_musteriler (
	musteriler_id INT,
    adresler_id INT,
    PRIMARY KEY (adresler_id, musteriler_id),
    FOREIGN KEY (adresler_id) REFERENCES adresler(id),
    FOREIGN KEY (musteriler_id) REFERENCES musteriler(id)
);

CREATE TABLE adresler_users (
	users_id INT,
    adresler_id INT,
    PRIMARY KEY (adresler_id, users_id),
    FOREIGN KEY (adresler_id) REFERENCES adresler(id),
    FOREIGN KEY (users_id) REFERENCES users(id)
);

CREATE TABLE telefon_nolar_musteriler (
	musteriler_id INT,
    telefon_nolar_id INT,
    PRIMARY KEY (telefon_nolar_id, musteriler_id),
    FOREIGN KEY (telefon_nolar_id) REFERENCES telefon_nolar(id),
    FOREIGN KEY (musteriler_id) REFERENCES musteriler(id)
);

CREATE TABLE telefon_nolar_users (
	users_id INT,
    telefon_nolar_id INT,
    PRIMARY KEY (telefon_nolar_id, users_id),
    FOREIGN KEY (telefon_nolar_id) REFERENCES telefon_nolar(id),
    FOREIGN KEY (users_id) REFERENCES users(id)
);

CREATE TABLE magzalar_users (
	users_id INT,
    magazalar_id INT,
    PRIMARY KEY (magazalar_id, users_id),
    FOREIGN KEY (magazalar_id) REFERENCES magazalar(id),
    FOREIGN KEY (users_id) REFERENCES users(id)
);
-- sıparısler

CREATE TABLE magzalar_siparis (
id INT AUTO_INCREMENT PRIMARY KEY,
siparis_tarih DATETIME DEFAULT CURRENT_TIMESTAMP,
adet INT,
magazalar_id INT,
urunler_id INT,
FOREIGN KEY (magazalar_id) REFERENCES magazalar(id),
FOREIGN KEY (urunler_id) REFERENCES urunler(id)
);

CREATE TABLE musteriler_siparis (
id INT AUTO_INCREMENT PRIMARY KEY,
siparis_tarih DATETIME DEFAULT CURRENT_TIMESTAMP,
adet INT,
musteriler_id INT,
urunler_id INT,
FOREIGN KEY (musteriler_id) REFERENCES musteriler(id),
FOREIGN KEY (urunler_id) REFERENCES urunler(id)
);